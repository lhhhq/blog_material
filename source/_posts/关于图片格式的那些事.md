---
layout: post
title: 关于图片格式的那些事
author: lhhhq
comments: true
date: 2016-02-09 12:08:12
description: 认识矢量图、位图、有损压缩、无损压缩的基本概念，主要介绍jpg和png两种图片格式及其应用。
tags:
- 位图
- 矢量图
categories:
- 设计常识
---

### 1 基本概念
* **矢量图**：根据组成图形的一些基本元素，如**点、线、面、边框、颜色等数据**来绘制和显示图像。
  · 优点：文件小，可任意放大缩小；
  · 缺点：这些完美的几何图形很难表现自然度高的写实图像。
  web页面上所使用的矢量图形，如矢量icon等，是指用矢量工具绘制，再导出为成位图格式用于web。

* **位图**：通过记录图像中**每一个点**（即像素点）**的颜色、深度、透明度等信息**来储存和显示图像。
  · 优点：有利于显示色彩丰富的的写实图像；
  · 缺点：文件大，放大或缩小会失真。
  web页面中所使用的JPG、PNG、GIF格式的图像都是位图。

* **有损压缩**：根据人眼观察事物的特性，去掉会被人眼忽略的细节，再**使用附近的颜色通过渐变或其他方式进行填充**，从而大大降低图像信息的数据量又不影响图像的还原效果。
  · 举例：JPG 储存时把图像分解成8×8像素的栅格，对每个栅格进行压缩处理。
  · 特点：不完全真实的记录图像上每个像素点的数据信息（即不管图像上的颜色多少，都会损失图像信息）；压缩率太高会产生块状模糊。

* **无损压缩**：通过特殊的算法，先判断图像上哪些区域的颜色是相同的，哪些是不同的，**将相同的信息进行压缩记录**（**从图像中挑选出来的具有代表性的颜色编号，每一编号对应一种颜色，使图像的数据量减少**），不同信息另外保存。
  · 举例：PNG 通过颜色判断后，**对所有图像上出现的颜色进行索引**（得到“索引色”，充当调色板），显示图像时就**用“调色板”上的颜色填充相应的位置**。
  · 特点：真实的记录图像上每个像素点的数据信息；只有当图像上的颜色数量少于可以储存的颜色数量时才能真实记录和还原图像，否则会丢失一些图像信息。
  （PNG8最多只能索引256种颜色，所以对于颜色较多的图像不能真实还原；PNG24可以保存1600多万种颜色，基本能够真实还原我们人类肉眼所可以分别的所有颜色；PNG格式最多可以保存48位颜色通道）

* **JPG和PNG对比**
  |  格式  | 压缩模式 | 交错支持 | 透明支持 | 动画支持 |
  | :--: | :--: | :--: | :--: | :--: |
  | JPG  | 有损压缩 |  支持  | 不支持  | 不支持  |
  | PNG  | 无损压缩 |  支持  |  支持  |  支持  |

  | 图片格式 | <span style="display:block; text-align:center">特性</span> |
  | :--: | :--------------------------------------- |
  | JPG  | · 支持摄影图像或写实图像的高级压缩，并且可利**用压缩比例控制**图像文件大小；<br>· 有损压缩会使图像数据质量下降，并且在编辑和重新保存JPG格式图像时，这种**下降损失会累积**；<br>· JPG不适用于所含颜色很少、具有大块颜色相近的区域或亮度差异十分明显的较简单的图片。 |
  | PNG  | · 能在保证最不失真的情况下尽可能压缩图像文件的大小；<br>· PNG用来存储灰度图像时，灰度图像的深度可多到16位，存储彩色图像时，彩色图像的深度可多到48位，并且还可存储多到16位的α通道数据；<br>· 对于需要高保真的**较复杂的图像，PNG虽然能无损压缩，但图片文件较大**，不适合应用在Web页面上。 |

  |  格式   | 最高支持色彩通道 | 索引色编辑支持 | <span style="display:block; text-align:center">透明支持</span> |
  | :---: | :------: | :-----: | :--------------------------------------- |
  | PNG8  |   256色   |   支持    | 支持1位（2阶）布尔透明（完全透明或完全不透明）                 |
  | PNG24 | 约1600万色  |   不支持   | 支持8位（256阶）alpha透明（半透明）                   |

  > 索引色编辑？
  > **索引颜色模式**：该模式采用一个颜色表存放并索引图像中的颜色使用最多 256 种颜色，当转换为索引颜色时，Photoshop将构建一个颜色查找表(CLUT)，用以存放并索引图像中的颜色。如果原图像中的某种颜色没有出现在该表中，则程序将选取现有颜色中最接近的一种，或使用现有颜色模拟该颜色。它只支持单通道图像(8位/像素)，因此，我们通过限制调色板、索引颜色减小文件大小，同时保持视觉上的品质不变--如用于多媒体动画的应用或网页。

* **PNG的种类**
  目前可用的PNG格式分5种：灰度图像、真彩图像（PNG24）、索引颜色图像（PNG8）、带alpha通道的灰度图像、带alpha通道的真彩图像。
  其中，alpha通道控制透明度，使图像支持不同程度的透明（即半透明），Fw中称为alpha透明。
  而对于PNG8，它支持两种透明：一种只能支持完全透明或完全不透明（bit transparency，即布尔透明，Fw中称索引色透明），一种可支持半透明（palette transparency，即alpha透明）。
  Photoshop能导出支持索引透明的PNG8、PNG24、支持半透明的PNG24；
  Fireworks能导出支持索引透明的PNG8、支持alpha透明的PNG8、PNG24、PNG32（在PNG24的基础上多了8位的alpha通道，相当于Ps中支持alpha透明的PNG24）

### 2 实际应用
* **何时使用JPG**
  对于写实的摄影图像或是颜色层次非常丰富的图像采用JPG的图片格式保存一般能达到最佳的压缩效果。

* **何时使用PNG**
  图像上颜色较少，并且主要以纯色或者平滑的渐变色进行填充；
  具备较大亮度差异以及强烈对比的简单图像。
  以下是不同PNG格式测试结果（以下图片出自[干货！PNG的使用技巧][1]）：
  1）对于移动端：
  {% asset_img mobile.jpg %}
  移动端采用『Png8 alpha透明』,文件体积小，且半透明效果好。
  2）对于PC端：
  {% asset_img pc.jpg %}
  高级浏览器使用png32图片，针对IE6使用『png8 索引透明』，并设置『png8 索引透明』杂边与背景色颜色一致可达到视觉上透明。
  『png8 alpha透明』在高清显示器下的质量不如png32，因此不使用。

* **JPG优化**
  推荐工具：[jpegtran][5]
  若使用Photoshop：
1. （此法较使用矩形的图像）对齐8×8网格再导出JPG，有利于JPG压缩；
2. （此法只适用于图像有较暗或较亮的颜色的图像）转为Lab通道，保持明度不变，使颜色变得一致（滤镜-杂色-中间值）；
3. 品质设置技巧：<br>
   {% asset_img jpg.png %} <br>
   ① **不要存100%品质的JPG格式图片**。因为100%并不一定是最高的品质，而是一个优化算法的极限值，所以会增加不必要的文件大小。建议存储**95%品质的图片就可以最大限度的降低失真**。
   ② **谨慎使用50%品质以下的压缩率**。使用50%以下品质存储时会采用额外的压缩算法而导致图片失真更严重，尤其是对于有高对比度的图片。
   ③ 连续：创建在 Web 浏览器中连续显示的图像。图像将显示为一系列的叠加，使查看者在整个图像下载完毕之前，能够看到图像的低分辨率版本。连续JPEG需要更多的内存用于查看，IE6不支持该选项。
   ④ 其余选项默认即可。

* **PNG优化**
  推荐工具：[OptiPNG][8]
  若使用Photoshop：
1. 色调分离（40左右）：尽量使相近的颜色变成一种颜色；
2. 对于使用蒙版的图像，其隐藏的像素占有空间，因此导出时应删除以去除隐藏的透明像素；
3. 不透明部分和透明部分分开储存，其中不透明部分导出PNG8，半透明部分导出PNG24（这样就把一张图变成了两张，其实不太实用，仅作思路参考）；
4. PNG参数设置：<br>
   {% asset_img png.png %} <br>
   ① 交错：图像可以以一种特殊方式存储，显示时先大概显示图像的草图，当文件全部下载后再填充细节。图像较大时建议勾选。
   ② 对于PNG8，杂色选与背景色相同的颜色，否则由于PNG8不支持半透明而将半透明像素默认变成全透明使导出的图像产生锯齿。
   ③ 其余选项默认即可。

参考文章
[图片格式与设计那点事儿][10]
[干货！PNG的使用技巧][11]
[Clever JPEG Optimization Techniques][12]
[Clever PNG Optimization Techniques][13]


[1]: http://www.xueui.cn/experience/png-skills-2.html
[2]: http://www.xueui.cn/wp-content/uploads/2016/01/13130wx_fmtpngamptpwebpampwxfrom13ampwx_lazy1313
[3]: http://www.xueui.cn/wp-content/uploads/2016/01/990wx_fmtjpegamptpwebpampwxfrom9ampwx_lazy99
[4]: https://www.smashingmagazine.com/2009/07/clever-jpeg-optimization-techniques/
[5]: http://sylvana.net/jpegcrop/jpegtran/
[7]: https://www.smashingmagazine.com/2009/07/clever-png-optimization-techniques/
[8]: http://optipng.sourceforge.net/
[10]: http://ued.taobao.org/blog/2010/12/jpg_png/
[11]: http://www.xueui.cn/experience/png-skills-2.html
[12]: https://www.smashingmagazine.com/2009/07/clever-jpeg-optimization-techniques/
[13]: https://www.smashingmagazine.com/2009/07/clever-png-optimization-techniques/